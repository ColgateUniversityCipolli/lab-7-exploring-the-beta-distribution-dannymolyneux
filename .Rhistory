new.cum.kurt = cumkurt(new.dat)
new.cum.dat = tibble(
data.points = 1:n,
mean = new.cum.mean,
variance = new.cum.var,
skewness = new.cum.skew,
kurtosis = new.cum.kurt
)
#update plots with a line for the new data
mean.plot = mean.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = mean), color = i)
var.plot = var.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = variance), color = i)
skew.plot = skew.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = skewness), color = i)
kurt.plot = kurt.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = kurtosis), color = i)
}
mean.plot + var.plot + skew.plot + kurt.plot
sample.distribution = data.frame() #data frame that will have all 1000 samples
for(i in 1:1000){
set.seed(7272+i)
beta.sample <- rbeta(n,  # sample size
alpha,   # alpha parameter
beta)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
new.sample.summary = beta.sample |> #numerical summary for each sample
summarize(
alpha = alpha, beta = beta, mean = mean(x), variance = var(x), skew = skewness(x), kurt = kurtosis(x)-3
)
#add the data for that sample
sample.distribution = bind_rows(sample.distribution, new.sample.summary)
}
view(sample.distribution)
mean.dist.plot = ggplot(data= sample.distribution, aes(x=mean))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0.1,0.4,0.005)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Mean")+
ylab("Density")+
labs(title = "Distribution of Mean")
var.dist.plot = ggplot(data= sample.distribution, aes(x=variance))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,0.05,0.0025)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Variance")+
ylab("Density")+
labs(title = "Distribution of Variance")
skew.dist.plot = ggplot(data= sample.distribution, aes(x=skew))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.1)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Skewness")+
ylab("Density")+
labs(title = "Distribution of Skewness")
kurt.dist.plot = ggplot(data= sample.distribution, aes(x=kurt))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(-0.5,0.5,0.1)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Excess Kurtosis")+
ylab("Density")+
labs(title = "Distribution of Excess Kurtosis")
#I notice that these variables follow a relatively normal distribution, especially the
#skewness and excess kurtosis. Obviously they aren't perfect because we are using samples,
#but you can see that their density lines have the bell curve shape
mean.dist.plot + var.dist.plot + skew.dist.plot + kurt.dist.plot
library(e1071)
sample = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.summary = beta.sample |> #numerical summary for each distribution
summarize(
alpha = alpha, beta = beta, mean = mean(x), variance = var(x), skew = skewness(x), kurt = kurtosis(x)
)
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
sample.plot
return(sample.summary)
}
sample(2,5)
sample.plot
library(e1071)
sample = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.summary = beta.sample |> #numerical summary for each distribution
summarize(
alpha = alpha, beta = beta, mean = mean(x), variance = var(x), skew = skewness(x), kurt = kurtosis(x)
)
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
sample.plot
plot = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
sample.plot
}
plot = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
sample.plot
}
plot(2, 5)
plot = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
return(sample.plot)
}
plot(2, 5)
plot = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
return(sample.plot)
}
plot(2, 5)
plot = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
return(sample.plot)
}
plot(2, 5)
plot.funct = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
return(sample.plot)
}
plot.funct(2, 5)
plot.funct = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
#beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
return(sample.plot)
}
plot.funct(2, 5)
plot.funct = function(alpha, beta){
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = alpha,   # alpha parameter
shape2 = beta)    # beta parameter
#beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, alpha, beta), color=paste("Beta(", alpha, ", ", beta, ")", sep = "")))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
return(sample.plot)
}
plot.funct(2, 5)
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = 2,   # alpha parameter
shape2 = 5)    # beta parameter
#beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, 2, 5), color="Beta(2, 5)"))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
sample.plot
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = 2,   # alpha parameter
shape2 = 5)    # beta parameter
#beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, 2, 5), color="Beta(2, 5)"))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
sample.plot
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = 2,   # alpha parameter
shape2 = 5)    # beta parameter
#beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, 2, 5), color="Beta(2, 5)"))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
set.seed(7272) # Set seed so we all get the same results.
sample.size <- 500 # Specify sample details
beta.sample <- rbeta(n = sample.size,  # sample size
shape1 = 2,   # alpha parameter
shape2 = 5)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
sample.plot = ggplot(data= beta.sample, aes(x=x))+                  # specify data
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.10)) +
geom_line(aes(x=x, y=dbeta(x, 2, 5), color="Beta(2, 5)"))+
geom_hline(yintercept=0)+                                            # plot x axis
theme_bw()+                                                          # change theme
geom_density(color = "blue") +
xlab("x")+                                                           # label x axis
ylab("Density")+                                                   # label y axis
labs(color = "")
print(sample.plot)
library(cumstats)
library(patchwork)
data_2_5 = beta.data[1, ] #true population values for beta(2, 5) (first row of task one data frame)
alpha = 2
beta = 5
n = 500
set.seed(7272)
sample.dat = rbeta(n, alpha, beta) #sample data
#view(sample.dat)
#cumulative variables
cum.mean = cummean(sample.dat)
cum.var = cumvar(sample.dat)
cum.skew = cumskew(sample.dat)
cum.kurt = cumkurt(sample.dat)
#data frame for the cumulative numerical summary
cum.dat = tibble(
data.points = 1:n,
mean = cum.mean,
variance = cum.var,
skewness = cum.skew,
kurtosis = cum.kurt
)
#view(data_2_5)
#plots for each cumulative variable
mean.plot = ggplot(cum.dat, aes(x=data.points, y = mean)) +
geom_line() +
geom_hline(yintercept = data_2_5$mean, linetype = "dashed", color = "blue") +
labs(title = "Cumulative mean for a Beta(2,5) sample", x = "# of data points", y = "Cumulative Mean")
var.plot = ggplot(cum.dat, aes(x=data.points, y = variance)) +
geom_line() +
geom_hline(yintercept = data_2_5$variance, linetype = "dashed", color = "blue") +
labs(title = "Cumulative variance for a Beta(2,5) sample", x = "# of data points", y = "Cumulative Variance")
skew.plot = ggplot(cum.dat, aes(x=data.points, y = skewness)) +
geom_line() +
geom_hline(yintercept = data_2_5$skew, linetype = "dashed", color = "blue") +
labs(title = "Cumulative skewness for a Beta(2,5) sample", x = "# of data points", y = "Cumulative Skewness")
kurt.plot = ggplot(cum.dat, aes(x=data.points, y = kurtosis)) +
geom_line() +
#adjust kurtosis by 3 because cumstats package uses regular kurtosis
geom_hline(yintercept = data_2_5$kurt + 3, linetype = "dashed", color = "blue") +
labs(title = "Cumulative kurtosis for a Beta(2,5) sample", x = "# of data points", y = "Cumulative Kurtosis")
mean.plot + var.plot + skew.plot + kurt.plot
for(i in 2:50){
set.seed(7272+i)
new.dat = rbeta(n, alpha, beta) #new sample of data
#new cumulative variables
new.cum.mean = cummean(new.dat)
new.cum.var = cumvar(new.dat)
new.cum.skew = cumskew(new.dat)
new.cum.kurt = cumkurt(new.dat)
new.cum.dat = tibble(
data.points = 1:n,
mean = new.cum.mean,
variance = new.cum.var,
skewness = new.cum.skew,
kurtosis = new.cum.kurt
)
#update plots with a line for the new data
mean.plot = mean.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = mean), color = i)
var.plot = var.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = variance), color = i)
skew.plot = skew.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = skewness), color = i)
kurt.plot = kurt.plot+geom_line(data=new.cum.dat, aes(x=data.points, y = kurtosis), color = i)
}
mean.plot + var.plot + skew.plot + kurt.plot
sample.distribution = data.frame() #data frame that will have all 1000 samples
for(i in 1:1000){
set.seed(7272+i)
beta.sample <- rbeta(n,  # sample size
alpha,   # alpha parameter
beta)    # beta parameter
beta.sample = data.frame(x = beta.sample) #turn it into a data frame
new.sample.summary = beta.sample |> #numerical summary for each sample
summarize(
alpha = alpha, beta = beta, mean = mean(x), variance = var(x), skew = skewness(x), kurt = kurtosis(x)-3
)
#add the data for that sample
sample.distribution = bind_rows(sample.distribution, new.sample.summary)
}
#view(sample.distribution)
#Distribution plots for each variable
mean.dist.plot = ggplot(data= sample.distribution, aes(x=mean))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0.1,0.4,0.005)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Mean")+
ylab("Density")+
labs(title = "Distribution of Mean")
var.dist.plot = ggplot(data= sample.distribution, aes(x=variance))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,0.05,0.0025)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Variance")+
ylab("Density")+
labs(title = "Distribution of Variance")
skew.dist.plot = ggplot(data= sample.distribution, aes(x=skew))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(0,1,0.1)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Skewness")+
ylab("Density")+
labs(title = "Distribution of Skewness")
kurt.dist.plot = ggplot(data= sample.distribution, aes(x=kurt))+
geom_histogram(aes(y=after_stat(density)),
#binwidth = 0.1
#bins=10
breaks=seq(-0.5,0.5,0.1)) +
geom_hline(yintercept=0)+
theme_bw()+
geom_density(color = "blue") +
xlab("Excess Kurtosis")+
ylab("Density")+
labs(title = "Distribution of Excess Kurtosis")
#I notice that these variables follow a relatively normal distribution, especially the
#skewness and excess kurtosis. Obviously they aren't perfect because we are using samples,
#but you can see that their density lines have the bell curve shape
mean.dist.plot + var.dist.plot + skew.dist.plot + kurt.dist.plot
